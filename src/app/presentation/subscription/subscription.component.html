<div class="subscription-container">
  <!-- Formulario de suscripción -->
  <div class="card form-card">
    <h2>Gestión de Suscripciones</h2>

    <form #form="ngForm" class="form-group">
      <!-- ID Cliente -->
      <div>
        <label for="customerId">ID Cliente</label>
        <input
          id="customerId"
          [(ngModel)]="customerId"
          name="customerId"
          placeholder="ej. 12345"
        />
      </div>

      <!-- Selección de plan -->
      <div>
        <label for="planSelect">Plan</label>
        <select
          id="planSelect"
          [(ngModel)]="selectedPlan"
          name="selectedPlan"
        >
          <option *ngFor="let p of plans" [value]="p.type">
            {{ p.name }} — ${{ p.monthlyCost }}/mes
          </option>
        </select>
      </div>

      <!-- Checkbox anualidad -->
      <div class="checkbox-group">
        <input
          type="checkbox"
          id="annual"
          [(ngModel)]="isAnnual"
          name="isAnnual"
        />
        <label for="annual">Pago Anual (10% desc.)</label>
      </div>

      <!-- Botones de acción -->
      <div class="form-actions">
        <button
          type="button"
          class="btn primary"
          (click)="subscribe()"
        >
          Suscribirse
        </button>
        <button
          type="button"
          class="btn secondary"
          (click)="update()"
        >
          Actualizar
        </button>
        <button
          type="button"
          class="btn danger"
          (click)="cancel()"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>

  <!-- Mensaje de reembolso -->
  <div *ngIf="refundMessage" class="alert">
    {{ refundMessage }}
  </div>

  <!-- Sección de suscripción actual -->
  <div class="card info-card" *ngIf="currentSubscription">
    <h3>Suscripción Actual</h3>
    <dl>
      <dt>Cliente:</dt><dd>{{ currentSubscription.customerId }}</dd>
      <dt>Plan:</dt><dd>{{ currentSubscription.planType }}</dd>
      <dt>Pago anual:</dt>
        <dd>{{ currentSubscription.isAnnual ? 'Sí' : 'No' }}</dd>
      <dt>Costo:</dt><dd>${{ currentSubscription.amountPaid }}</dd>
      <dt *ngIf="currentSubscription.nextPlanType">
        Próximo plan:
      </dt>
      <dd *ngIf="currentSubscription.nextPlanType">
        {{ currentSubscription.nextPlanType }}
      </dd>
    </dl>
  </div>

  <!-- Tabla de suscripciones activas -->
  <div class="card list-card" *ngIf="allSubscriptions.length > 0">
    <h3>Suscripciones Activas</h3>
    <table class="subscription-table">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Plan</th>
          <th>Anual</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let s of allSubscriptions">
          <td>{{ s.customerId }}</td>
          <td>{{ s.planType }}</td>
          <td>{{ s.isAnnual ? 'Sí' : 'No' }}</td>
          <td>{{ s.status }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
